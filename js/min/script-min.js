function scrollPage(){if(myScroll=$(document).scrollTop(),$(window).width()<=767){var e=$(".wrapper-popup").offset().top;myScroll>e?TweenMax.set($(".btn-close-popup"),{className:"+=fixed"}):TweenMax.set($(".btn-close-popup"),{className:"-=fixed"})}requestAnimFrame(scrollPage)}function animSprites(e,a,s,t,o,n){i=0;var p=new SteppedEase(o-1);for(i;n>i;i++)a.add(TweenMax.fromTo(e,.2,{backgroundPosition:"0 -"+t*i+"px"},{backgroundPosition:"-"+s*(o-1)+"px -"+t*i+"px",ease:p}))}function compteur(){var e=5347,a=5302,s=new Odometer({el:$(".compteur-participants")[0],theme:"train-station",value:a,format:""});s.render(),setInterval(function(){e>=a&&s.update(a++)},3e3)}function decompteur(){$(".decompteur-event").countdown({until:new Date(2016,4,25),compact:!0,layout:"<span class='digit-group'><span class='digit'>{d10}</span><span class='digit'>{d1}</span><span class='legend'>jours</span></span>:<span class='digit-group'><span class='digit'>{h10}</span><span class='digit'>{h1}</span><span class='legend'>heures</span></span>:<span class='digit-group'><span class='digit'>{m10}</span><span class='digit'>{m1}</span><span class='legend'>min</span></span>:<span class='digit-group'><span class='digit'>{s10}</span><span class='digit'>{s1}</span><span class='legend'>sec</span></span>",padZeroes:!0})}function posiPopup(){$(".popup").each(function(e){$(window).width()<=767?(TweenMax.set($(this),{"margin-top":"0px","margin-left":"0px"}),TweenMax.set($(this),{className:"+=no-transform"})):(TweenMax.set($(this),{"margin-top":-$(this).outerHeight()/2+"px","margin-left":-$(this).outerWidth()/2+"px"}),TweenMax.set($(this),{className:"+=no-transform"}))})}function posiSprites(){animSprites($("#glow"),spritesGlow,635,200,5,5),$(window).width()>767?animSprites($("#cape"),spritesCape,96,58,2,3):$(window).width()>530?animSprites($("#cape"),spritesCape,72,44,2,3):$(window).width()>374?animSprites($("#cape"),spritesCape,52,31,2,3):animSprites($("#cape"),spritesCape,44,27,2,3)}function illus(){posiSprites();var e=new TimelineMax({});e.set($("#ensemble-crew"),{opacity:0,bottom:"70%"}).from($("#prix"),1.5,{scale:.1,alpha:0,ease:Elastic.easeInOut}).insert(TweenMax.to($("#ensemble-crew"),.7,{delay:1.7,alpha:1,bottom:"11%",ease:Back.easeOut}),TweenMax.to($("#prix"),.7,{delay:1.7,scaleX:1,scaleY:1,bottom:"7%",ease:Back.easeOut}),TweenMax.to($("#ombre-prix"),.3,{delay:2.2,opacity:1}),TweenMax.to($("#ombre-socle"),.2,{delay:1.7,className:"+=first-step"}))}var i,myScroll,spritesTab,spritesCape=new TimelineMax({repeat:-1}),spritesGlow=new TimelineMax({repeat:-1});window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}(),$(function(){compteur(),decompteur(),scrollPage(),illus(),$("#etapes-event >li").mouseenter(function(){$("#etapes-event").removeClass("etape-1-active etape-2-active etape-3-active etape-4-active"),$(this).hasClass("etape-1")?$("#etapes-event").addClass("etape-1-active"):$(this).hasClass("etape-2")?$("#etapes-event").addClass("etape-2-active"):$(this).hasClass("etape-3")?$("#etapes-event").addClass("etape-3-active"):$(this).hasClass("etape-4")&&$("#etapes-event").addClass("etape-4-active")}),$(".title-etape").click(function(){var e=$("#etapes-event >li.open");if($(this).parent(".etape").hasClass("open"))$(".content-etape",e).slideToggle(300),e.removeClass("open");else{$(".content-etape",e).slideToggle(300),e.removeClass("open");var a=$(this).parent(".etape");$(".content-etape",a).slideToggle(300),a.addClass("open")}return!1}),$(".radio").click(function(){if(!$(this).hasClass("active")){var e=$(this).parent("fieldset");$(".radio.active",e).removeClass("active"),$(this).addClass("active")}}),$(".has-popup").click(function(){var e=$(this).data("ref-popup"),a=$(".wrapper-popup[data-popup='"+e+"']");return a.hasClass("open")||($(".wrapper-popup").removeClass("open"),a.addClass("open"),$(window).width()<=767&&$("html, body").stop().animate({scrollTop:a.offset().top},800)),posiPopup(),!1}),$(".btn-close-popup").click(function(){return $(this).parents(".wrapper-popup").removeClass("open"),!1}),$(document).mouseup(function(e){if($(window).width()>767){var a=$(".wrapper-popup.open .popup");a.is(e.target)||0!=a.has(e.target).length||$(".wrapper-popup.open").removeClass("open")}});var e=$("#quantite");e.data("oldVal",e.val()),e.bind("propertychange change click keyup input paste",function(a){e.data("oldVal")!=e.val()&&(e.data("oldVal",e.val()),$(this)[0].setCustomValidity(e.val()>=500?"":"Minimum 500 litres"))}),new Clipboard(".btn-clipboard"),$(document).delegate("#partage-email .btn-plus","click",function(){return $("#partage-email ul").append('<li><input type="email" placeholder="Saisir l\'email de votre choix"><button class="btn-plus"></button></li>'),posiPopup(),!1}),$("#btn-partage-email").click(function(){return $(this).closest(".popup").addClass("email-open"),posiPopup(),!1}),$("#btn-close-partage-email").click(function(){return $(this).closest(".popup").removeClass("email-open"),posiPopup(),!1})}),$(window).load(function(){posiPopup()});var h=$(window).height(),w=$(window).width();$(window).resize(function(){posiPopup();var e=$(window).height(),a=$(window).width();a!=w&&($(".content-etape").attr("style",""),$("#etapes-event >li.open").removeClass("open"),$("#etapes-event >li").first().addClass("open"),spritesCape.clear(),posiSprites()),h=e,w=a}),$(document).on("scroll",function(){myScroll=$(document).scrollTop(),19>myScroll?($("#prix").removeClass("break"),TweenMax.to($("#prix"),.3,{bottom:"7%",scaleX:"1",scaleY:"1"}),TweenMax.to($("#ombre-prix"),.2,{scaleX:"1"}),TweenMax.to($("#ensemble-crew"),1,{bottom:"11%",ease:Elastic.easeOut.config(2,.5)}),TweenMax.to($("#ombre-socle"),.2,{className:"+=first-step"}),TweenMax.to($("#ombre-socle"),.2,{className:"-=second-step"}),TweenMax.to($("#ombre-socle"),.2,{className:"-=third-step"}),TweenMax.to($("#ombre-socle"),.2,{className:"-=fourth-step"})):myScroll>=20&&59>myScroll?($("#prix").addClass("break"),TweenMax.to($("#prix"),.3,{bottom:"7%",scaleX:"1",scaleY:"1"}),TweenMax.to($("#ombre-prix"),.2,{scaleX:"1"}),TweenMax.fromTo($("#ensemble-crew"),.3,{bottom:"10%"},{bottom:"11%",ease:Elastic.easeOut.config(2,.5)}),TweenMax.to($("#ombre-socle"),.2,{className:"+=first-step"}),TweenMax.to($("#ombre-socle"),.2,{className:"-=second-step"}),TweenMax.to($("#ombre-socle"),.2,{className:"-=third-step"}),TweenMax.to($("#ombre-socle"),.2,{className:"-=fourth-step"})):myScroll>=60&&249>myScroll?(TweenMax.to($("#prix"),.3,{bottom:"5%",scaleX:"0.95",scaleY:"0.75"}),TweenMax.to($("#ombre-prix"),.2,{scaleX:"0.95"}),TweenMax.to($("#ensemble-crew"),1,{bottom:"7%",ease:Elastic.easeOut.config(2,.5)}),$("#prix").addClass("break"),TweenMax.to($("#ombre-socle"),.2,{className:"-=first-step"}),TweenMax.to($("#ombre-socle"),.2,{className:"+=second-step"}),TweenMax.to($("#ombre-socle"),.2,{className:"-=third-step"}),TweenMax.to($("#ombre-socle"),.2,{className:"-=fourth-step"})):myScroll>=250&&349>myScroll?($("#prix").addClass("break"),TweenMax.to($("#prix"),.6,{bottom:"4%",scaleX:"0.92",scaleY:"0.62",ease:Elastic.easeOut.config(2,.5)}),TweenMax.to($("#ombre-prix"),.2,{scaleX:"0.92"}),TweenMax.to($("#ensemble-crew"),1,{bottom:"5%",ease:Elastic.easeOut}),TweenMax.to($("#ombre-socle"),.2,{className:"-=first-step"}),TweenMax.to($("#ombre-socle"),.2,{className:"-=second-step"}),TweenMax.to($("#ombre-socle"),.2,{className:"+=third-step"}),TweenMax.to($("#ombre-socle"),.2,{className:"-=fourth-step"})):myScroll>=350&&600>myScroll&&($("#prix").addClass("break"),TweenMax.to($("#prix"),.6,{bottom:"3%",scaleX:"0.9",scaleY:"0.4",ease:Elastic.easeOut.config(2,.5)}),TweenMax.to($("#ombre-prix"),.2,{scaleX:"0.9"}),TweenMax.to($("#ensemble-crew"),1,{bottom:"3%",ease:Elastic.easeOut}),TweenMax.to($("#ombre-socle"),.2,{className:"-=first-step"}),TweenMax.to($("#ombre-socle"),.2,{className:"-=second-step"}),TweenMax.to($("#ombre-socle"),.2,{className:"-=third-step"}),TweenMax.to($("#ombre-socle"),.2,{className:"+=fourth-step"}))});